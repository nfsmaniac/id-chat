/*!
* country-region-selector
* ------------------------
* 0.3.4
* @author Ben Keen
* @repo https://github.com/benkeen/country-region-selector
* @licence MIT
*/
$("."+a).each(i)},i=function(){var a=this,c=a.getAttribute("data-crs-loaded");if("true"!==c){a.length=0;var e=$(a).attr("data-default-option"),g=e?e:b,h=a.getAttribute("data-show-default-option");d=null===h?!0:"true"===h;var i=$(a).attr("data-default-value"),l=$(a).attr("data-value"),o=0;d&&(this.options[0]=new Option(g,"")),k({whitelist:a.getAttribute("data-whitelist"),blacklist:a.getAttribute("data-blacklist")});for(var p=0;p<f.length;p++){var q="shortcode"==l||"2-char"===l?f[p][1]:f[p][0];a.options[a.length]=new Option(f[p][0],q),null!=i&&i===q&&(o=p,d&&o++)}this.selectedIndex=o;var r=$(a).attr("data-region-id");if(!r)return void console.error("Missing data-region-id on country-region-selector country field.");var s=$("#"+r)[0];if(s)if(j(s),$(this).on("change",function(){n(a,s)}),i&&a.selectedIndex>0){n(a,s);var t=$(s).attr("data-default-value"),u="shortcode"===s.getAttribute("data-value");if(null!==t){var v=d?a.selectedIndex-1:a.selectedIndex,w=f[v][3];m(s,w,t,u)}}else d===!1&&n(a,s);else console.error("Region dropdown DOM node with ID "+r+" not found.");a.setAttribute("data-crs-loaded","true")}},j=function(a){var b=$(a).attr("data-blank-option"),c=b?b:"-",d=a.getAttribute("data-show-default-option");e=null===d?!0:"true"===d,a.length=0,e&&(a.options[0]=new Option(c,""),a.selectedIndex=0)},k=function(a){var b=g,c=[],d=0;if(a.whitelist){var e=a.whitelist.split(",");for(d=0;d<g.length;d++)-1!==e.indexOf(g[d][1])&&c.push(g[d]);b=c}else if(a.blacklist){var h=a.blacklist.split(",");for(d=0;d<g.length;d++)-1===h.indexOf(g[d][1])&&c.push(g[d]);b=c}f=b,l()},l=function(){for(var a=0;a<f.length;a++){for(var b={hasShortcodes:/~/.test(f[a][2]),regions:[]},c=f[a][2].split("|"),d=0;d<c.length;d++){var e=c[d].split("~");b.regions.push([e[0],e[1]])}f[a][3]=b}},m=function(a,b,c,d){for(var f=0;f<b.regions.length;f++){var g=d&&b.hasShortcodes&&b.regions[f][1]?b.regions[f][1]:b.regions[f][0];if(g===c){a.selectedIndex=e?f+1:f;break}}},n=function(a,b){var g=d?a.selectedIndex-1:a.selectedIndex,h=$(b).attr("data-default-option"),i=b.getAttribute("data-value"),k=h?h:c;if(""===a.value)j(b);else{b.length=0,e&&(b.options[0]=new Option(k,""));for(var l=f[g][3],m=0;m<l.regions.length;m++){var n="shortcode"===i&&l.hasShortcodes?l.regions[m][1]:l.regions[m][0];b.options[b.length]=new Option(l.regions[m][0],n)}b.selectedIndex=0}};return $(h),{init:h}});
